<!DOCTYPE html>
<!-- saved from url=(0075)file:///C:/Users/calvi/Documents/GitHub/radio_web_app/listener_profile.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Listener_profile</title>

	<link rel="stylesheet" type="text/css" href="/listener.css">


	<style>

		.icon-button{
			cursor: pointer;
		}

		.main_section{
			border: solid;
			border-color: black;
			background: #28282b;
			display: flex;
			flex-direction: row;
			height: 755px;
			justify-content: space-around;
		}


		.category-container{
			text-align: center;
			width: 100%;
			display: flex;
			flex-direction: column;


		}
		
		

		.audio_control{
			height: 70%;
			width: 70%;
			margin-left: auto;
			margin-top: auto;
			margin-bottom: auto;
			margin-right: 10px;
		}

		
		

		img{
			border-radius:50%;
			height: 200px;
			width: 200px;
			justify-self: start;
			align-self: center;
		}

		.main_section div{
			flex: auto;
			display: flex;
			flex-direction: column;
			justify-content: center;
		}
		.user_data{
			padding: 20px;
			width: 50%;
			margin-top: auto;
			margin-bottom: auto;
			border-style: solid;
			border-radius: 35px;
		}
		.user_data button{
			margin-left: 80%;
		}

		hr{
			border-color: black;
			border-top: solid ;
			
		}
		.form-popup{
			display: none;
		}

		::-webkit-scrollbar {
   		 -webkit-appearance: none;
   			 width: 15px;
}
		::-webkit-scrollbar-thumb{
			background-color:#6699CC ;
		}
		::-webkit-scrollbar-track{
			background-color: rgb(66, 69, 73);
		}
		
	</style>
	
</head>
<body style="color:#6699CC" >
	<nav class="nav_bar">	

		<div class="nav_bar_left">
			<button class="listener" onclick="window.location.href='/listener_main'">Listener</button>
			<button class="dj">DJ</button>
			<button class="producer">Producer</button>
		</div>


		<div class="nav_bar_middle"> PAGE TITLE
			
		</div>


		<div class="nav_bar_right"> 
			<button class="profile">Profile</button>



			<form name = myForm action='http://localhost:8080/listener_main' onsubmit="return validateForm()" method='POST' >
				<input class="search" type="text" id="search" name="search">
				<input class="sub" type="submit" value="Submit">
			</form>
		</div>

	</nav>

	<div class="media_bar">
		<audio controls="" class="audio_control">
			<source src="mck.mp3" type="audio/mpeg">
		</audio>
	</div>

	<main class="main_section">
		<div>
			<img src="/images/user_icon.jpg">

		</div>

		<div class="user_data">

			<p style="font-size: 40px;" id = "info"></p>
		</div>
	
	<script >



			const user = <%- JSON.stringify(user[0])%>;
			const info = document.getElementById("info");
			const edit = document.getElementById("edit");

			info.innerHTML = displayInfo();

			
			const elems = document.querySelectorAll(".edit-info-button");

			for(let i =0; i<elems.length; i++){
				elems[i].addEventListener("click", function(){
					showEditPrompt(elems[i].parentElement);
				});
			}
			

			


			function displayInfo(){
				return `
					<div>
						<div style="display:flex;flex-direction:row;justify-content:flex-start" name="firstName">
							<span>First Name:&nbsp;</span>
							<span>${user.firstName}</span>
							<div style="flex: 1"></div>
							<div style="flex:0" class="icon-button edit-info-button">
								<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24"><path d="M120-120v-170l528-527q12-11 26.5-17t30.5-6q16 0 31 6t26 18l55 56q12 11 17.5 26t5.5 30q0 16-5.5 30.5T817-647L290-120H120Zm584-528 56-56-56-56-56 56 56 56Z"/></svg>
							</div>
						</div>
						<hr style="width:100%">
						<div style="display:flex;flex-direction:row;justify-content:flex-start" name="lastName">
							<span>Last Name:&nbsp;</span>
							<span>${user.lastName}</span>
							<div style="flex: 1"></div>
							<div style="flex:0" class="icon-button edit-info-button">
								<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24"><path d="M120-120v-170l528-527q12-11 26.5-17t30.5-6q16 0 31 6t26 18l55 56q12 11 17.5 26t5.5 30q0 16-5.5 30.5T817-647L290-120H120Zm584-528 56-56-56-56-56 56 56 56Z"/></svg>
							</div>
						</div>
						<hr style="width:100%">
						<div style="display:flex;flex-direction:row;justify-content:flex-start" name="dob">
							<span>Date of Birth:&nbsp;</span>
							<span>${user.dob}</span>
							<div style="flex: 1"></div>
							<div style="flex:0" class="icon-button edit-info-button">
								<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24"><path d="M120-120v-170l528-527q12-11 26.5-17t30.5-6q16 0 31 6t26 18l55 56q12 11 17.5 26t5.5 30q0 16-5.5 30.5T817-647L290-120H120Zm584-528 56-56-56-56-56 56 56 56Z"/></svg>
							</div>
						</div>
						<hr style="width:100%">
						<div style="display:flex;flex-direction:row;justify-content:flex-start" name="email">
							<span>Email:&nbsp;</span>
							<span>${user.email}</span>
							<div style="flex: 1"></div>
							<div style="flex:0" class="icon-button edit-info-button">
								<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24"><path d="M120-120v-170l528-527q12-11 26.5-17t30.5-6q16 0 31 6t26 18l55 56q12 11 17.5 26t5.5 30q0 16-5.5 30.5T817-647L290-120H120Zm584-528 56-56-56-56-56 56 56 56Z"/></svg>
							</div>
						</div>
						<hr style="width:100%">
						<div style="display:flex;flex-direction:row;justify-content:flex-start" name="phoneNum">
							<span>Phone Number:&nbsp;</span>
							<span>${user.phoneNum}</span>
							<div style="flex: 1"></div>
							<div style="flex:0" class="icon-button edit-info-button">
								<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24"><path d="M120-120v-170l528-527q12-11 26.5-17t30.5-6q16 0 31 6t26 18l55 56q12 11 17.5 26t5.5 30q0 16-5.5 30.5T817-647L290-120H120Zm584-528 56-56-56-56-56 56 56 56Z"/></svg>
							</div>
						</div>
						
					</div>
				`;
			}

			async function showEditPrompt(elem){
				
				const spans = elem.querySelectorAll("span");
				const result = prompt(spans[0].innerHTML.replace("&nbsp;",""), spans[1].innerHTML);
				// elem.getAttribute("name") = "phoneNum" => user["phoneNum"] = result;
				if(result){
					user[elem.getAttribute("name")] = result;
					spans[1].innerHTML = result;


					const res = await fetch('http://localhost:8080/listener_profile',{
						method:'POST',
						headers:{"Content-Type": 'application/json'},
						body: JSON.stringify(user)						
					}).then(res => { console.log("Request complete! response:", res)});
					

				}


			}


				
			
			function validateForm() {
			  var x = document.forms["myForm"]["search"].value;
			  if (x == "" || x == null) {
			    alert("Please enter keywords.");
			    return false;
			  }
			}
	

			

	</script>
	</main>

			<footer class="foot_note"> Footnote			
			</footer>

	

</body></html>